<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="../../style.css">
    <title>Formula 1</title>
</head>
<body>
    <ol id="lista" class="list-group"></ol>
    <script>
        
        function response_received(response) {
            return response.json()
        }

        function parse_data(content) {
            let lista = document.getElementById("lista");
            content.carrera.sort(function (a, b) {
                if (a.posicion === 0) {
                    return 1;
                }
                if (b.posicion === 0) {
                    return -1;
                }
                if (a.posicion > b.posicion) {
                    return 1;
                }
                if (a.posicion < b.posicion) {
                    return -1;
                }
                // a must be equal to b
                return 0;
            });
            for (index in content.carrera) {
                let img = document.createElement('img');
                img.src = content.carrera[index].escuderia_imagen;
                img.style.width = '36px';
                img.style.height = '36px';
                img.classList.add('img-icon');

                let span = document.createElement('span');
                span.classList.add('badge', 'badge-primary', 'badge-pill');
                span.innerText = (content.carrera[index].puntos);

                let li = document.createElement('li');
                li.classList.add('list-group-item', 'd-flex', 'justify-content-between', 'align-items-center', 'col-auto');
                li.innerText = (content.carrera[index].piloto_nombre + ' ' + content.carrera[index].piloto_apellido);
                li.style.margin = '10 auto';
                li.appendChild(img);
                li.appendChild(span);
                lista.appendChild(li);
            };
        
        }
        function request_error(error) {
            console.log("ERROR")
            console.log(error);
        }
        const params = new URLSearchParams(window.location.search);
        const id = params.get("id");
        const fecha = params.get("fecha");
        
        fetch(`http://localhost:5000/fechas/tabla/${fecha}&${id}`)
            .then(response_received)
            .then(parse_data)
            .catch(request_error)
    </script>
</body>
</html>
